!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("lodash"),require("immutable"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","lodash","immutable","react-dom"],t):"object"==typeof exports?exports.ReactTransitionable=t(require("react"),require("lodash"),require("immutable"),require("react-dom")):n.ReactTransitionable=t(n.React,n._,n.Immutable,n.ReactDOM)}(this,function(n,t,e,i){return function(n){function t(i){if(e[i])return e[i].exports;var r=e[i]={exports:{},id:i,loaded:!1};return n[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var e={};return t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){n.exports=e(1)},function(n,t,e){var i=e(2),r=e(3),s=(e(4),e(5)),o=e(6)("react-transitionable"),a=i.createClass({displayName:"Transitionable",propTypes:{children:i.PropTypes.oneOfType([i.PropTypes.arrayOf(i.PropTypes.shape({key:i.PropTypes.string})),i.PropTypes.shape({key:i.PropTypes.string})]),className:i.PropTypes.string,childClassName:i.PropTypes.string,style:i.PropTypes.object,childStyle:i.PropTypes.object,transitionIn:i.PropTypes.func,transitionOut:i.PropTypes.func,transitionOther:i.PropTypes.func,onTransitionsStart:i.PropTypes.func,onTransitionsComplete:i.PropTypes.func},getDefaultProps:function(){return{className:null,childClassName:null,style:{},childStyle:{},transitionIn:function(n,t,e){e()},transitionOut:function(n,t,e){e()},transitionOther:function(n,t,e){e()}}},getInitialState:function(){var n=this.getChildrenAsArray(this.props.children);return{children:n,allChildren:n,transitioningChildren:[],transitioningIn:[],transitioningOut:[],transitioningOther:[]}},render:function(){var n=this.state.allChildren.map(r.bind(this.renderChildren,this)),t=["transitionable-views"];return this.props.className&&this.props.className.length&&t.push(this.props.className),i.createElement("div",{className:t.join(" "),style:this.props.style},n)},renderChildren:function(n,t){var e="t-"+n.key,s=["transitionable-view"];return this.props.childClassName&&this.props.childClassName.length&&s.push(this.props.childClassName),r.indexOf(this.state.transitioningIn,n.key)>-1?s.push("transitioning transitioning-in"):r.indexOf(this.state.transitioningOut,n.key)>-1?s.push("transitioning transitioning-out"):r.indexOf(this.state.transitioningOther,n.key)>-1&&s.push("transitioning transitioning-other"),i.createElement("div",{className:s.join(" "),key:e,ref:e,style:this.props.childStyle},n)},componentWillMount:function(){this.transitionChildren({mounting:!0})},componentWillReceiveProps:function(n){var t=this.getChildrenAsArray(n.children),e=[];r.each(this.state.children,function(n){var i=r.find(t,function(t){return t.key===n.key});e.push(i?i:n)});var i=[];r.each(this.state.transitioningChildren,function(n){var e=r.find(t,function(t){return t.key===n.key});i.push(e?e:n)});var s=r.uniq(r.union(e,i),function(n){return n.key});this.props.children!==n.children&&r.each(t,function(n){var t=r.findIndex(s,function(t){return t.key===n.key});t===-1&&s.push(n)}),this.setState({children:e,transitioningChildren:i,allChildren:s})},componentDidUpdate:function(n,t){var e=r.map(this.getChildrenAsArray(this.props.children),"key").join("|"),i=r.map(this.getChildrenAsArray(n.children),"key").join("|");e!==i&&this.transitionChildren()},transitionChildren:function(n){n=r.extend({mounting:!1,allChildrenKeys:r.map(this.state.allChildren,"key")},n);var t=this.getChildrenAsArray(this.props.children),e=r.uniq(r.union(this.state.children,this.state.transitioningChildren),function(n){return n.key}),i=r.map(e,"key"),s=r.map(this.state.children,"key"),a=r.map(t,"key"),c=r.difference(i,a),l=r.difference(a,r.difference(s,this.state.transitioningOut)),u=r.difference(i,c,l),h=[];if(o("Current keys",s),o("Next keys",a),o("Children to remove",c),o("Children to add",l),o("Children others",u),o("---"),c.length)for(var p=0,f=c.length;p<f;p++){var d=c[p];h.push({direction:"out",key:d})}if(l.length)for(var m=0,g=l.length;m<g;m++){var d=l[m];h.push({direction:"in",key:d})}if(u.length)for(var y=0,C=u.length;y<C;y++){var d=u[y];h.push({direction:"other",key:d})}var v=r.filter(this.state.allChildren,function(n){return r.indexOf(l,n.key)!==-1||r.indexOf(c,n.key)!==-1}),T=r.union(this.state.transitioningChildren,v),k=r.uniq(T,function(n){return n.key});this.setState({transitioningChildren:k},function(){this.callTransitions(h,n),!n.mounting&&this.props.onTransitionsStart&&this.props.onTransitionsStart()})},callTransitions:function(n,t){var e=r.map(n,"key"),i=r.map(r.filter(n,["direction","in"]),"key"),s=r.map(r.filter(n,["direction","out"]),"key"),a=r.map(r.filter(n,["direction","other"]),"key"),c=r.difference(r.union(this.state.transitioningIn,i),s,a),l=r.difference(r.union(this.state.transitioningOut,s),i,a),u=r.difference(r.union(this.state.transitioningOther,a),i,s),h=r.filter(n,r.bind(function(n){return"in"===n.direction?r.indexOf(this.state.transitioningIn,n.key)===-1:"out"===n.direction?r.indexOf(this.state.transitioningOut,n.key)===-1:"other"===n.direction?r.indexOf(this.state.transitioningOther,n.key)===-1:void 0},this)),p=r.difference(r.map(h,"key"),u);o("Should transitions",e),o("Will transitions",r.map(h,"key")),o("Transitioning in",c),o("Transitioning out",l),o("Transitioning other",u),this.setState({transitioningIn:c,transitioningOut:l,transitioningOther:u},function(){for(var n=0,e=0,o=h.length;e<o;e++){var c=h[e];this.callTransition(c.direction,c.key,t,function(){n++,o===n&&this.setState({transitioningIn:r.difference(this.state.transitioningIn,i),transitioningOut:r.difference(this.state.transitioningOut,s),transitioningOther:r.difference(this.state.transitioningOther,a)},function(){this.onAllTransitionComplete(p)})})}})},callTransition:function(n,t,e,i){var o=s.findDOMNode(this.refs["t-"+t]),a=n.substr(0,1).toUpperCase()+n.substr(1),c=r.find(this.state.allChildren,function(n){return n.key===t}),l={el:o,key:t,props:c?c.props:{}},u=r.bind(function(){this.onTransitionComplete(l,n),this["onTransition"+a+"Complete"](l,c),setTimeout(r.bind(i,this),0)},this),h=this.props["transition"+a].call(this,l,e,u);h&&r.isFunction(h.then)&&h.then(u)},getChildrenAsArray:function(n){var t=n;return r.isArray(t)||(t=t?[t]:[]),t},onTransitionComplete:function(n,t){this.props.onTransitionComplete&&this.props.onTransitionComplete(n,t)},onTransitionInComplete:function(n){this.props.onTransitionInComplete&&this.props.onTransitionInComplete(n)},onTransitionOutComplete:function(n){this.props.onTransitionOutComplete&&this.props.onTransitionOutComplete(n)},onTransitionOtherComplete:function(n){this.props.onTransitionOtherComplete&&this.props.onTransitionOtherComplete(n)},onAllTransitionComplete:function(n){o("All transitionings completed",n);var t=r.filter(this.state.transitioningChildren,function(t){return r.indexOf(n,t.key)===-1}),e=this.getChildrenAsArray(this.props.children),i=r.union(e,t),s=r.uniq(i,function(n){return n.key});this.setState({allChildren:s,children:e,transitioningChildren:t},function(){o("Transitioning children",this.state.transitioningChildren),o("Transitioning in",this.state.transitioningIn),o("Transitioning out",this.state.transitioningOut),o("Transitioning other",this.state.transitioningOther),this.props.onTransitionsComplete&&this.props.onTransitionsComplete()})}});n.exports=a},function(t,e){t.exports=n},function(n,e){n.exports=t},function(n,t){n.exports=e},function(n,t){n.exports=i},function(n,t,e){function i(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+t.humanize(this.diff),!e)return n;var i="color: "+this.color;n=[n[0],i,"color: inherit"].concat(Array.prototype.slice.call(n,1));var r=0,s=0;return n[0].replace(/%[a-z%]/g,function(n){"%%"!==n&&(r++,"%c"===n&&(s=r))}),n.splice(s,0,i),n}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(n){try{null==n?t.storage.removeItem("debug"):t.storage.debug=n}catch(e){}}function a(){var n;try{n=t.storage.debug}catch(e){}return n}function c(){try{return window.localStorage}catch(n){}}t=n.exports=e(7),t.log=s,t.formatArgs=r,t.save=o,t.load=a,t.useColors=i,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(n){return JSON.stringify(n)},t.enable(a())},function(n,t,e){function i(){return t.colors[u++%t.colors.length]}function r(n){function e(){}function r(){var n=r,e=+new Date,s=e-(l||e);n.diff=s,n.prev=l,n.curr=e,l=e,null==n.useColors&&(n.useColors=t.useColors()),null==n.color&&n.useColors&&(n.color=i());var o=Array.prototype.slice.call(arguments);o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var a=0;o[0]=o[0].replace(/%([a-z%])/g,function(e,i){if("%%"===e)return e;a++;var r=t.formatters[i];if("function"==typeof r){var s=o[a];e=r.call(n,s),o.splice(a,1),a--}return e}),"function"==typeof t.formatArgs&&(o=t.formatArgs.apply(n,o));var c=r.log||t.log||console.log.bind(console);c.apply(n,o)}e.enabled=!1,r.enabled=!0;var s=t.enabled(n)?r:e;return s.namespace=n,s}function s(n){t.save(n);for(var e=(n||"").split(/[\s,]+/),i=e.length,r=0;r<i;r++)e[r]&&(n=e[r].replace(/\*/g,".*?"),"-"===n[0]?t.skips.push(new RegExp("^"+n.substr(1)+"$")):t.names.push(new RegExp("^"+n+"$")))}function o(){t.enable("")}function a(n){var e,i;for(e=0,i=t.skips.length;e<i;e++)if(t.skips[e].test(n))return!1;for(e=0,i=t.names.length;e<i;e++)if(t.names[e].test(n))return!0;return!1}function c(n){return n instanceof Error?n.stack||n.message:n}t=n.exports=r,t.coerce=c,t.disable=o,t.enable=s,t.enabled=a,t.humanize=e(8),t.names=[],t.skips=[],t.formatters={};var l,u=0},function(n,t){function e(n){if(n=""+n,!(n.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(n);if(t){var e=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return e*u;case"days":case"day":case"d":return e*l;case"hours":case"hour":case"hrs":case"hr":case"h":return e*c;case"minutes":case"minute":case"mins":case"min":case"m":return e*a;case"seconds":case"second":case"secs":case"sec":case"s":return e*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e}}}}function i(n){return n>=l?Math.round(n/l)+"d":n>=c?Math.round(n/c)+"h":n>=a?Math.round(n/a)+"m":n>=o?Math.round(n/o)+"s":n+"ms"}function r(n){return s(n,l,"day")||s(n,c,"hour")||s(n,a,"minute")||s(n,o,"second")||n+" ms"}function s(n,t,e){if(!(n<t))return n<1.5*t?Math.floor(n/t)+" "+e:Math.ceil(n/t)+" "+e+"s"}var o=1e3,a=60*o,c=60*a,l=24*c,u=365.25*l;n.exports=function(n,t){return t=t||{},"string"==typeof n?e(n):t["long"]?r(n):i(n)}}])});