!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("lodash"),require("immutable"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","lodash","immutable","react-dom"],e):"object"==typeof exports?exports.ReactTransitionable=e(require("react"),require("lodash"),require("immutable"),require("react-dom")):n.ReactTransitionable=e(n.React,n._,n.Immutable,n.ReactDOM)}(this,function(n,e,t,i){return function(n){function e(i){if(t[i])return t[i].exports;var r=t[i]={exports:{},id:i,loaded:!1};return n[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var t={};return e.m=n,e.c=t,e.p="",e(0)}([function(n,e,t){n.exports=t(1)},function(n,e,t){var i=t(2),r=t(3),s=(t(4),t(5)),o=t(6)("app:transitionable"),a=i.createClass({displayName:"Transitionable",propTypes:{children:i.PropTypes.oneOfType([i.PropTypes.arrayOf(i.PropTypes.shape({key:i.PropTypes.string})),i.PropTypes.shape({key:i.PropTypes.string})]),className:i.PropTypes.string,childClassName:i.PropTypes.string,style:i.PropTypes.object,childStyle:i.PropTypes.object,transitionIn:i.PropTypes.func,transitionOut:i.PropTypes.func,transitionOther:i.PropTypes.func,onTransitionsStart:i.PropTypes.func,onTransitionsComplete:i.PropTypes.func},getDefaultProps:function(){return{className:null,childClassName:null,style:{},childStyle:{},transitionIn:function(n,e,t){t()},transitionOut:function(n,e,t){t()},transitionOther:function(n,e,t){t()}}},getInitialState:function(){var n=this.getChildrenAsArray(this.props.children);return{children:n,allChildren:n,transitioningChildren:[],transitioningIn:[],transitioningOut:[],transitioningOther:[]}},render:function(){var n=this.state.allChildren.map(r.bind(this.renderChildren,this)),e=["transitionable-views"];return this.props.className&&this.props.className.length&&e.push(this.props.className),i.createElement("div",{className:e.join(" "),style:this.props.style},n)},renderChildren:function(n,e){var t="t-"+n.key,s=["transitionable-view"];return this.props.childClassName&&this.props.childClassName.length&&s.push(this.props.childClassName),r.indexOf(this.state.transitioningIn,n.key)>-1?s.push("transitioning transitioning-in"):r.indexOf(this.state.transitioningOut,n.key)>-1?s.push("transitioning transitioning-out"):r.indexOf(this.state.transitioningOther,n.key)>-1&&s.push("transitioning transitioning-other"),i.createElement("div",{className:s.join(" "),key:t,ref:t,style:this.props.childStyle},n)},componentWillMount:function(){this.transitionChildren({mounting:!0})},componentWillReceiveProps:function(n){var e=this.getChildrenAsArray(n.children),t=[];r.each(this.state.children,function(n){var i=r.find(e,"key",n.key);t.push(i?i:n)});var i=[];r.each(this.state.transitioningChildren,function(n){var t=r.find(e,"key",n.key);i.push(t?t:n)});var s=r.uniq(r.union(t,i),function(n){return n.key});this.props.children!==n.children&&r.each(e,function(n){var e=r.findIndex(s,"key",n.key);e===-1&&s.push(n)}),this.setState({children:t,transitioningChildren:i,allChildren:s})},componentDidUpdate:function(n,e){var t=r.map(this.getChildrenAsArray(this.props.children),"key").join("|"),i=r.map(this.getChildrenAsArray(n.children),"key").join("|");t!==i&&this.transitionChildren()},transitionChildren:function(n){n=r.extend({mounting:!1,allChildrenKeys:r.map(this.state.allChildren,"key")},n);var e=this.getChildrenAsArray(this.props.children),t=r.uniq(r.union(this.state.children,this.state.transitioningChildren),function(n){return n.key}),i=r.map(t,"key"),s=r.map(this.state.children,"key"),a=r.map(e,"key"),c=r.difference(i,a),l=r.difference(a,r.difference(s,this.state.transitioningOut)),u=r.difference(i,c,l),h=[];if(o("Current keys",s),o("Next keys",a),o("Children to remove",c),o("Children to add",l),o("Children others",u),o("---"),c.length)for(var p=0,f=c.length;p<f;p++){var d=c[p];h.push({direction:"out",key:d})}if(l.length)for(var m=0,y=l.length;m<y;m++){var d=l[m];h.push({direction:"in",key:d})}if(u.length)for(var g=0,C=u.length;g<C;g++){var d=u[g];h.push({direction:"other",key:d})}var v=r.filter(this.state.allChildren,function(n){return r.indexOf(l,n.key)!==-1||r.indexOf(c,n.key)!==-1}),k=r.union(this.state.transitioningChildren,v),T=r.uniq(k,function(n){return n.key});this.setState({transitioningChildren:T},function(){this.callTransitions(h,n),!n.mounting&&this.props.onTransitionsStart&&this.props.onTransitionsStart()})},callTransitions:function(n,e){var t=(r.map(n,"key"),r.map(r.filter(n,["direction","in"]),"key")),i=r.map(r.filter(n,["direction","out"]),"key"),s=r.map(r.filter(n,["direction","other"]),"key"),o=r.difference(r.union(this.state.transitioningIn,t),i,s),a=r.difference(r.union(this.state.transitioningOut,i),t,s),c=r.difference(r.union(this.state.transitioningOther,s),t,i),l=r.filter(n,r.bind(function(n){return"in"===n.direction?r.indexOf(this.state.transitioningIn,n.key)===-1:"out"===n.direction?r.indexOf(this.state.transitioningOut,n.key)===-1:"other"===n.direction?r.indexOf(this.state.transitioningOther,n.key)===-1:void 0},this)),u=r.difference(r.map(l,"key"),c);this.setState({transitioningIn:o,transitioningOut:a,transitioningOther:c},function(){for(var n=0,o=0,a=l.length;o<a;o++){var c=l[o];this.callTransition(c.direction,c.key,e,function(){n++,a===n&&this.setState({transitioningIn:r.difference(this.state.transitioningIn,t),transitioningOut:r.difference(this.state.transitioningOut,i),transitioningOther:r.difference(this.state.transitioningOther,s)},function(){this.onAllTransitionComplete(u)})})}})},callTransition:function(n,e,t,i){var o=s.findDOMNode(this.refs["t-"+e]),a=n.substr(0,1).toUpperCase()+n.substr(1),c=r.find(this.state.allChildren,["key",e]),l={el:o,key:e,props:c?c.props:{}},u=r.bind(function(){this.onTransitionComplete(l,n),this["onTransition"+a+"Complete"](l,c),setTimeout(r.bind(i,this),0)},this),h=this.props["transition"+a].call(this,l,t,u);h&&r.isFunction(h.then)&&h.then(u)},getChildrenAsArray:function(n){var e=n;return r.isArray(e)||(e=e?[e]:[]),e},onTransitionComplete:function(n,e){this.props.onTransitionComplete&&this.props.onTransitionComplete(n,e)},onTransitionInComplete:function(n){this.props.onTransitionInComplete&&this.props.onTransitionInComplete(n)},onTransitionOutComplete:function(n){this.props.onTransitionOutComplete&&this.props.onTransitionOutComplete(n)},onTransitionOtherComplete:function(n){this.props.onTransitionOtherComplete&&this.props.onTransitionOtherComplete(n)},onAllTransitionComplete:function(n){o("All transitionings completed",n);var e=r.filter(this.state.transitioningChildren,function(e){return r.indexOf(n,e.key)===-1}),t=this.getChildrenAsArray(this.props.children),i=r.union(t,e),s=r.uniq(i,function(n){return n.key});this.setState({allChildren:s,children:t,transitioningChildren:e},function(){this.props.onTransitionsComplete&&this.props.onTransitionsComplete()})}});n.exports=a},function(e,t){e.exports=n},function(n,t){n.exports=e},function(n,e){n.exports=t},function(n,e){n.exports=i},function(n,e,t){function i(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var n=arguments,t=this.useColors;if(n[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+n[0]+(t?"%c ":" ")+"+"+e.humanize(this.diff),!t)return n;var i="color: "+this.color;n=[n[0],i,"color: inherit"].concat(Array.prototype.slice.call(n,1));var r=0,s=0;return n[0].replace(/%[a-z%]/g,function(n){"%%"!==n&&(r++,"%c"===n&&(s=r))}),n.splice(s,0,i),n}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(n){try{null==n?e.storage.removeItem("debug"):e.storage.debug=n}catch(t){}}function a(){var n;try{n=e.storage.debug}catch(t){}return n}function c(){try{return window.localStorage}catch(n){}}e=n.exports=t(7),e.log=s,e.formatArgs=r,e.save=o,e.load=a,e.useColors=i,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(n){return JSON.stringify(n)},e.enable(a())},function(n,e,t){function i(){return e.colors[u++%e.colors.length]}function r(n){function t(){}function r(){var n=r,t=+new Date,s=t-(l||t);n.diff=s,n.prev=l,n.curr=t,l=t,null==n.useColors&&(n.useColors=e.useColors()),null==n.color&&n.useColors&&(n.color=i());var o=Array.prototype.slice.call(arguments);o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var a=0;o[0]=o[0].replace(/%([a-z%])/g,function(t,i){if("%%"===t)return t;a++;var r=e.formatters[i];if("function"==typeof r){var s=o[a];t=r.call(n,s),o.splice(a,1),a--}return t}),"function"==typeof e.formatArgs&&(o=e.formatArgs.apply(n,o));var c=r.log||e.log||console.log.bind(console);c.apply(n,o)}t.enabled=!1,r.enabled=!0;var s=e.enabled(n)?r:t;return s.namespace=n,s}function s(n){e.save(n);for(var t=(n||"").split(/[\s,]+/),i=t.length,r=0;r<i;r++)t[r]&&(n=t[r].replace(/\*/g,".*?"),"-"===n[0]?e.skips.push(new RegExp("^"+n.substr(1)+"$")):e.names.push(new RegExp("^"+n+"$")))}function o(){e.enable("")}function a(n){var t,i;for(t=0,i=e.skips.length;t<i;t++)if(e.skips[t].test(n))return!1;for(t=0,i=e.names.length;t<i;t++)if(e.names[t].test(n))return!0;return!1}function c(n){return n instanceof Error?n.stack||n.message:n}e=n.exports=r,e.coerce=c,e.disable=o,e.enable=s,e.enabled=a,e.humanize=t(8),e.names=[],e.skips=[],e.formatters={};var l,u=0},function(n,e){function t(n){if(n=""+n,!(n.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*u;case"days":case"day":case"d":return t*l;case"hours":case"hour":case"hrs":case"hr":case"h":return t*c;case"minutes":case"minute":case"mins":case"min":case"m":return t*a;case"seconds":case"second":case"secs":case"sec":case"s":return t*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t}}}}function i(n){return n>=l?Math.round(n/l)+"d":n>=c?Math.round(n/c)+"h":n>=a?Math.round(n/a)+"m":n>=o?Math.round(n/o)+"s":n+"ms"}function r(n){return s(n,l,"day")||s(n,c,"hour")||s(n,a,"minute")||s(n,o,"second")||n+" ms"}function s(n,e,t){if(!(n<e))return n<1.5*e?Math.floor(n/e)+" "+t:Math.ceil(n/e)+" "+t+"s"}var o=1e3,a=60*o,c=60*a,l=24*c,u=365.25*l;n.exports=function(n,e){return e=e||{},"string"==typeof n?t(n):e["long"]?r(n):i(n)}}])});